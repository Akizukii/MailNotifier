(function(e){function t(t){for(var r,n,i=t[0],l=t[1],u=t[2],d=0,f=[];d<i.length;d++)n=i[d],Object.prototype.hasOwnProperty.call(s,n)&&s[n]&&f.push(s[n][0]),s[n]=0;for(r in l)Object.prototype.hasOwnProperty.call(l,r)&&(e[r]=l[r]);c&&c(t);while(f.length)f.shift()();return o.push.apply(o,u||[]),a()}function a(){for(var e,t=0;t<o.length;t++){for(var a=o[t],r=!0,i=1;i<a.length;i++){var l=a[i];0!==s[l]&&(r=!1)}r&&(o.splice(t--,1),e=n(n.s=a[0]))}return e}var r={},s={app:0},o=[];function n(t){if(r[t])return r[t].exports;var a=r[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=r,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(a,r,function(t){return e[t]}.bind(null,r));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/MailNotifier/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],l=i.push.bind(i);i.push=t,i=i.slice();for(var u=0;u<i.length;u++)t(i[u]);var c=l;o.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"024c":function(e,t,a){"use strict";var r=a("3ddf"),s=a.n(r);s.a},"039a":function(e,t,a){"use strict";var r=a("fd06"),s=a.n(r);s.a},"3ddf":function(e,t,a){},"56d7":function(e,t,a){"use strict";a.r(t);var r=a("2b0e"),s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"App"}},[a("link",{attrs:{href:"https://fonts.googleapis.com/css?family=Material+Icons",rel:"stylesheet"}}),a("v-app",[a("router-view")],1)],1)},o=[],n={name:"App",components:{},data:()=>({})},i=n,l=a("2877"),u=a("6544"),c=a.n(u),d=a("7496"),f=Object(l["a"])(i,s,o,!1,null,null,null),p=f.exports;c()(f,{VApp:d["a"]});var m=a("f309");r["a"].use(m["a"]);var h=new m["a"]({icons:{iconfont:"mdi"}}),v=a("2f62");r["a"].use(v["a"]);var g=new v["a"].Store({state:{token:""},mutations:{set_token(e,t){e.token=t,localStorage.token=t},del_token(e){e.token="",localStorage.removeItem("token")}},actions:{}}),b=a("2427"),w=a.n(b),_=a("8c4f"),x=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{attrs:{fluid:""}},[a("v-card",{staticClass:"mx-auto",attrs:{"max-width":"auto"}},[a("v-card-title",[e._v("登陆")]),a("v-divider"),a("div",{staticClass:"form"},[a("v-form",{ref:"form",attrs:{"lazy-validation":""}},[a("v-text-field",{attrs:{rules:e.emailRules,label:"邮箱",clearable:"",required:""},model:{value:e.userform.username,callback:function(t){e.$set(e.userform,"username",t)},expression:"userform.username"}}),a("v-text-field",{attrs:{rules:[e.rules.required],"append-icon":e.show?"visibility":"visibility_off",label:"密码",type:e.show?"text":"password",clearable:""},on:{"click:append":function(t){e.show=!e.show}},model:{value:e.userform.password,callback:function(t){e.$set(e.userform,"password",t)},expression:"userform.password"}}),a("v-col",[a("v-row",{attrs:{justify:"start",align:"center"}},[a("v-btn",{staticClass:"ma-2",attrs:{loading:e.loading,outlined:"",color:"indigo"},on:{click:e.submit}},[e._v("\n        登陆\n        ")]),a("v-btn",{staticClass:"ma-2",attrs:{outlined:"",color:"indigo"},on:{click:e.resetform}},[e._v("\n        重置\n        ")])],1)],1)],1)],1)],1)],1)},k=[],y={name:"login",data(){return{loading:!1,show:!1,userform:{username:"",password:""},rules:{required:e=>!!e||"必须填写的内容",min:e=>e.length>=6||"Min 6 characters",emailMatch:()=>"The email and password you entered don't match"},emailRules:[e=>!!e||"必须填写的内容",e=>/.+@.+\..+/.test(e)||"邮箱格式错误"]}},methods:{resetform(){this.$refs.form.reset()},submit(){const e=this;this.loading=!0,this.$refs.form.validate()?(this.$axios.defaults.auth={username:e.userform.username,password:e.userform.password},this.$axios.get("/api/login").then(e=>{let t=e.data;this.$store.commit("set_token",t),this.$router.push("/")}).catch(t=>{alert("密码或用户名错误或服务器炸了"),e.loading=!1})):(alert("表单验证不通过"),e.loading=!1)}}},$=y,V=(a("039a"),a("8336")),j=a("b0af"),C=a("99d9"),O=a("62ad"),M=a("a523"),S=a("ce7e"),q=a("4bd4"),P=a("0fd9"),T=a("8654"),L=Object(l["a"])($,x,k,!1,null,null,null),E=L.exports;c()(L,{VBtn:V["a"],VCard:j["a"],VCardTitle:C["b"],VCol:O["a"],VContainer:M["a"],VDivider:S["a"],VForm:q["a"],VRow:P["a"],VTextField:T["a"]});var F=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{attrs:{fluid:""}},[a("v-card",{staticClass:"mx-auto",attrs:{"max-width":"auto"}},[a("v-card-title",[e._v("个人资料")]),a("v-divider"),a("v-card-text",[e._v("邮箱："+e._s(e.userform.username))]),a("v-card-text",[e._v("是否订阅:"),a("v-switch",{attrs:{loading:e.loading,disabled:e.a},on:{change:e.change},model:{value:e.userform.status,callback:function(t){e.$set(e.userform,"status",t)},expression:"userform.status"}})],1),a("v-form",{staticClass:"form"},[a("v-text-field",{attrs:{label:"新密码",rules:[e.rules.required],required:""},model:{value:e.new_pass,callback:function(t){e.new_pass=t},expression:"new_pass"}}),a("v-text-field",{attrs:{label:"确认新密码",rules:[e.rules.required],required:""},model:{value:e.confirm_pass,callback:function(t){e.confirm_pass=t},expression:"confirm_pass"}}),a("v-btn",{attrs:{loading:e.btnLoading},on:{click:e.changePass}},[e._v("确认修改密码")])],1),a("v-card-text",[a("v-btn",{on:{click:e.logout}},[e._v("退出")])],1)],1)],1)},R=[],A={name:"index",data(){return{a:!1,loading:!1,btnLoading:!1,userform:{},new_pass:"",confirm_pass:"",rules:{required:e=>!!e||"必须填写的内容",min:e=>e.length>=6||"Min 6 characters",emailMatch:()=>"The email and password you entered don't match"}}},methods:{logout(){this.$store.commit("del_token"),this.$router.push("/login")},change(){const e=this;this.loading=!0,this.a=!0,this.$axios.put("/api/update_mail_status",e.userform).then(t=>{e.loading=!1,e.a=!1}).catch(t=>{alert("修改失败，大概是服务器炸了"),e.loading=!1})},changePass(){const e=this;this.btnLoading=!0,this.new_pass===this.confirm_pass?(this.userform["password"]=this.new_pass,console.log(this.userform),this.$axios.put("/api/update_password",e.userform).then(t=>{alert("修改成功"),e.btnLoading=!1}).catch(t=>{alert("修改失败，大概是服务器炸了"),e.btnLoading=!1})):(alert("请确保两次输入的一样"),this.btnLoading=!1)}},created(){this.$axios.get("/").then(e=>{this.userform=e.data}).catch(e=>{console.log(e),this.$Message.error(e)})}},B=A,D=(a("024c"),a("b73d")),I=Object(l["a"])(B,F,R,!1,null,null,null),J=I.exports;c()(I,{VBtn:V["a"],VCard:j["a"],VCardText:C["a"],VCardTitle:C["b"],VContainer:M["a"],VDivider:S["a"],VForm:q["a"],VSwitch:D["a"],VTextField:T["a"]}),r["a"].use(_["a"]);var N=new _["a"]({mode:"history",base:"/MailNotifier/",routes:[{path:"/",name:"index",component:J,meta:{required:!0}},{path:"/login",name:"login",component:E}]});r["a"].config.productionTip=!1,w.a.defaults.baseURL="http://123.207.251.193:81",w.a.defaults.auth={username:"",password:""},w.a.interceptors.response.use(e=>{return e},e=>{if(e.response)switch(e.response.status){case 401:g.commit("del_token"),N.push("/login")}return Promise.reject(e.response.data)}),N.beforeEach((e,t,a)=>{e.meta.required?localStorage.token?(g.commit("set_token",localStorage.token),w.a.defaults.auth={username:g.state.token,password:g.state.token},a()):a({path:"/login"}):a()}),r["a"].prototype.$axios=w.a,new r["a"]({store:g,vuetify:h,router:N,render:e=>e(p)}).$mount("#app")},fd06:function(e,t,a){}});
//# sourceMappingURL=app.2fc81cb4.js.map